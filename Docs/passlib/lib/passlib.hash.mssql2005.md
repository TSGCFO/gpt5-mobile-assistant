<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mysql323.html "passlib.hash.mysql323 - MySQL 3.2.3 password hash")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html "passlib.hash.mssql2000 - MS SQL 2000 password hash")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.mssql2005`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html\#passlib.hash.mssql2005 "passlib.hash.mssql2005") \- MS SQL 2005 password hash [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html\#passlib-hash-mssql2005-ms-sql-2005-password-hash "Permalink to this headline")

Danger

**This algorithm is not considered secure by modern standards.**
It should only be used when verifying existing hashes,
or when interacting with applications that require this format.
For new code, see the list of [recommended hashes](https://passlib.readthedocs.io/en/stable/narr/quickstart.html#recommended-hashes).

New in version 1.6.

This class implements the hash algorithm used by Microsoft SQL Server 2005
to store its user account passwords, replacing the slightly less secure
[`mssql2000`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html#passlib.hash.mssql2000 "passlib.hash.mssql2000") variant.
This class can be used directly as follows:

```
>>> from passlib.hash import mssql2005 as m25

>>> # hash password
>>> h = m25.hash("password")
>>> h
'0x01006ACDF9FF5D2E211B392EEF1175EFFE13B3A368CE2F94038B'

>>> # verify password
>>> m25.verify("password", h)
True
>>> m25.verify("letmein", h)
False

```

See also

- [password hash usage](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples) – for more usage examples
- [mssql2000](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html) – the predecessor to this hash.

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `mssql2005` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html#passlib.hash.mssql2005 "Permalink to this definition")

This class implements the password hash used by MS-SQL 2005, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a fixed-length salt.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_bytes_](https://docs.python.org/3/library/stdtypes.html#bytes "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 4 bytes in length.<br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include<br>  `salt` strings that are too long. |

## Format & Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html\#format-algorithm "Permalink to this headline")

MSSQL 2005 hashes are usually presented as a series of 52 upper-case
hexadecimal characters, prefixed by `0x`. An example MSSQL 2005 hash
(of `"password"`):

```
0x01006ACDF9FF5D2E211B392EEF1175EFFE13B3A368CE2F94038B

```

This encodes 26 bytes of raw data, consisting of:

- a 2-byte constant `0100`
- 4 byte of salt ( `6ACDF9FF` in the example)
- 20 byte digest ( `5D2E211B392EEF1175EFFE13B3A368CE2F94038B`
in the example).

The digest is generated by encoding the unicode password using
`UTF-16-LE`, and calculating `SHA1(encoded_secret + salt)`.

This format and algorithm is identical to [mssql2000](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html),
except that this hash omits the 2nd case-insensitive
digest used by MSSQL 2000.

Note

MSSQL 2005 hashes do not actually have a native textual format, as they
are stored as raw bytes in an SQL table. However, when external programs
deal with them, MSSQL generally encodes raw bytes as upper-case hexadecimal,
prefixed with `0x`. This is the representation Passlib uses.

## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html\#security-issues "Permalink to this headline")

This algorithm is reasonably weak, and shouldn’t be used for any
purpose besides manipulating existing MSSQL 2005 hashes. This mainly due to
its simplicity, and years of research on high-speed SHA1
implementations, which makes efficient brute force attacks feasible.

Footnotes

|     |     |
| --- | --- |
| \[1\] | Overview hash algorithms used by MSSQL -<br>[https://blogs.msdn.com/b/lcris/archive/2007/04/30/sql-server-2005-about-login-password-hashes.aspx?Redirected=true](https://blogs.msdn.com/b/lcris/archive/2007/04/30/sql-server-2005-about-login-password-hashes.aspx?Redirected=true). |

|     |     |
| --- | --- |
| \[2\] | Description of MSSQL 2000/2005 algorithm -<br>[http://www.theregister.co.uk/2002/07/08/cracking\_ms\_sql\_server\_passwords/](http://www.theregister.co.uk/2002/07/08/cracking_ms_sql_server_passwords/). |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
      - [`passlib.hash.mssql2000` \- MS SQL 2000 password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html)
      - [`passlib.hash.mssql2005` \- MS SQL 2005 password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html#)
        - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html#interface)
        - [Format & Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html#format-algorithm)
        - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html#security-issues)
      - [`passlib.hash.mysql323` \- MySQL 3.2.3 password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mysql323.html)
      - [`passlib.hash.mysql41` \- MySQL 4.1 password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mysql41.html)
      - [`passlib.hash.postgres_md5` \- PostgreSQL MD5 password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.postgres_md5.html)
      - [`passlib.hash.oracle10` \- Oracle 10g password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.oracle10.html)
      - [`passlib.hash.oracle11` \- Oracle 11g password hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.oracle11.html)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mysql323.html "passlib.hash.mysql323 - MySQL 3.2.3 password hash")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html "passlib.hash.mssql2000 - MS SQL 2000 password hash")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.mssql2005.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2005.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.mssql2005.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)