<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.argon2.html "passlib.hash.argon2 - Argon2")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bigcrypt.html "passlib.hash.bigcrypt - BigCrypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.crypt16`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#passlib.hash.crypt16 "passlib.hash.crypt16") \- Crypt16 [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#passlib-hash-crypt16-crypt16 "Permalink to this headline")

Danger

**This algorithm is dangerously insecure by modern standards.**
It is trivially broken, and should not be used if at all possible.
For new code, see the list of [recommended hashes](https://passlib.readthedocs.io/en/stable/narr/quickstart.html#recommended-hashes).

This class implements the Crypt16 password hash, commonly
found on Ultrix and Tru64. It’s a minor modification of [`des_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#passlib.hash.des_crypt "passlib.hash.des_crypt"),
which allows passwords of up to 16 characters.

See also

[password hash usage](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples) –
for examples of how to use this class via the common hash interface.

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `crypt16` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#passlib.hash.crypt16 "Permalink to this definition")

This class implements the crypt16 password hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a fixed-length salt.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 2 characters, drawn from the regexp range `[./0-9A-Za-z]`.<br>- **truncate\_error** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, crypt16 will silently truncate passwords larger than 16 bytes.<br>  Setting `truncate_error=True` will cause [`hash()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.hash "passlib.ifc.PasswordHash.hash")<br>  to raise a [`PasswordTruncateError`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasswordTruncateError "passlib.exc.PasswordTruncateError") instead.<br>  <br>  <br>  <br>  New in version 1.7.<br>  <br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include<br>  `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

## Format [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#format "Permalink to this headline")

An example hash (of the string `passphrase`) is `aaX/UmCcBrceQ0kQGGWKTbuE`.
A crypt16 hash string has the format `saltchecksum_1checksum_2`, where:

- `salt` is the salt, stored as a 2 character
[`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64 "passlib.utils.binary.h64")-encoded 12-bit integer ( `aa` in the
example).
- each `checksum_i` is a separate checksum, stored as an 11 character
[`hash64-big`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64big "passlib.utils.binary.h64big")-encoded 64-bit integer
( `X/UmCcBrceQ` and `0kQGGWKTbuE` in the example).

Note

This hash is frequently confused with the [bigcrypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bigcrypt.html)
hash algorithm, as it has the same size and uses the same character
set as a `bigcrypt` hash of a password with 9 to 16
characters; though the actual algorithms are different.

## Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#algorithm "Permalink to this headline")

The crypt16 algorithm uses a weakened version of the des-crypt algorithm:

1. Given a password string and a salt string.

2. The 2 character salt string is decoded to a 12-bit integer salt value;
The salt string uses little-endian [`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64 "passlib.utils.binary.h64")
encoding.

3. If the password is larger than 16 bytes, the end is truncated to 16 bytes.
If the password is smaller than 16 bytes, the end is NULL padded to 16 bytes.

4. The lower 7 bits of the first 8 characters of the password are used
to form a 56-bit integer; with the first character providing
the most significant 7 bits, and the 8th character providing
the least significant 7 bits.

5. 20 repeated rounds of modified DES encryption are performed;
starting with a null input block,
and using the 56-bit integer from step 4 as the DES key.

The salt value from step 2 is used to to mutate the normal
DES encrypt operation by swapping bits `i` and `i+24`
in the DES E-Box output if and only if bit `i` is set in
the salt value.

6. The 64-bit result of the last round of step 5 is then
lsb-padded with 2 zero bits.

7. The resulting 66-bit integer is encoded in big-endian order
using the [`hash64-big`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64big "passlib.utils.binary.h64big") format.
This is the first checksum segment.

8. The second checksum segment is created by repeating
steps 4..7 using the second 8 bytes of the padding password (from step 3).
The only difference is that step 5 uses only 5 rounds.

9. The final checksum string is the concatenation of the two checksum segments,
in order.


## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#security-issues "Permalink to this headline")

Crypt16 is dangerously flawed:

- It suffers from all the flaws of [`des_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#passlib.hash.des_crypt "passlib.hash.des_crypt").
- Compared to des-crypt, its smaller number of rounds
makes it even _more_ vulnerable to brute-force attacks.
- For a given salt, passwords under 9 characters all have the same 2nd checksum.
Given the 12-bit salt size, all such 2nd checksums can be easily pre-computed;
making an attack easier, and giving away information about password size.
- Since both checksums use the same salt, they can be attacked at once
(by doing 5 rounds, checking the result against checksum 2,
doing 15 rounds more, and checking the result against checksum 1).

## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html\#deviations "Permalink to this headline")

This implementation of crypt16 deviates from public documentation of the format in one way:

- Unicode Policy:

The original crypt16 algorithm was designed for 7-bit `us-ascii` encoding only
(as evidenced by the fact that it discards the 8th bit of all password bytes).

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through crypt16. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| \[1\] | One source of information about bigcrypt & crypt16 -<br>[http://www.mail-archive.com/exim-dev@exim.org/msg00970.html](http://www.mail-archive.com/exim-dev@exim.org/msg00970.html) |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
      - [Active Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#active-unix-hashes)
      - [Deprecated Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#deprecated-unix-hashes)
      - [Archaic Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#archaic-unix-hashes)
        - [`passlib.hash.des_crypt` \- DES Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html)
        - [`passlib.hash.bsdi_crypt` \- BSDi Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bsdi_crypt.html)
        - [`passlib.hash.bigcrypt` \- BigCrypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bigcrypt.html)
        - [`passlib.hash.crypt16` \- Crypt16](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#interface)
          - [Format](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#format)
          - [Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#algorithm)
          - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#security-issues)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html#deviations)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.argon2.html "passlib.hash.argon2 - Argon2")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bigcrypt.html "passlib.hash.bigcrypt - BigCrypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.crypt16.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.crypt16.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)