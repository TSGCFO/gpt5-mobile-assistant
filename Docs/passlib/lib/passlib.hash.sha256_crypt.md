<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html "passlib.hash.sha512_crypt - SHA-512 Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt.html "passlib.hash.bcrypt - BCrypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.sha256_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#passlib.hash.sha256_crypt "passlib.hash.sha256_crypt") \- SHA-256 Crypt [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#passlib-hash-sha256-crypt-sha-256-crypt "Permalink to this headline")

SHA-256 Crypt and SHA-512 Crypt were developed in 2008 by Ulrich Drepper [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#f1),
designed as the successor to [`md5_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#passlib.hash.md5_crypt "passlib.hash.md5_crypt").
They include fixes and advancements such as variable rounds, and use of NIST-approved cryptographic primitives.
The design involves repeated composition of the underlying digest algorithm,
using various arbitrary permutations of inputs.
SHA-512 / SHA-256 Crypt are currently the default password hash for many systems
(notably Linux), and have no known weaknesses.
SHA-256 Crypt is one of the four hashes Passlib [recommends](https://passlib.readthedocs.io/en/stable/narr/quickstart.html#recommended-hashes)
for new applications.
This class can be used directly as follows:

```
>>> from passlib.hash import sha256_crypt

>>> # generate new salt, hash password
>>> hash = sha256_crypt.hash("password")
>>> hash
'$5$rounds=80000$wnsT7Yr92oJoP28r$cKhJImk5mfuSKV9b3mumNzlbstFUplKtQXXMo4G6Ep5'

>>> # same, but with explict number of rounds
>>> sha256_crypt.using(rounds=12345).hash("password")
'$5$rounds=12345$q3hvJE5mn5jKRsW.$BbbYTFiaImz9rTy03GGi.Jf9YY5bmxN0LU3p3uI1iUB'

>>> # verify password
>>> sha256_crypt.verify("password", hash)
True
>>> sha256_crypt.verify("letmein", hash)
False

```

See also

- [password hash usage](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples) – for more usage examples
- [sha512\_crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html) – the companion 512-bit version of this hash.

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `sha256_crypt` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#passlib.hash.sha256_crypt "Permalink to this definition")

This class implements the SHA256-Crypt password hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a variable-length salt, and a variable number of rounds.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 0-16 characters, drawn from the regexp range `[./0-9A-Za-z]`.<br>- **rounds** ( [_int_](https://docs.python.org/3/library/functions.html#int "(in Python v3.9)")) – <br>  Optional number of rounds to use.<br>  Defaults to 535000, must be between 1000 and 999999999, inclusive.<br>  <br>  <br>  <br>  Note<br>  <br>  <br>  <br>  per the official specification, when the rounds parameter is set to 5000,<br>  it may be omitted from the hash string.<br>  <br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include `rounds`<br>  that are too small or too large, and `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

Note

This class will use the first available of two possible backends:

- stdlib `crypt()`, if the host OS supports SHA256-Crypt (most Linux systems).
- a pure python implementation of SHA256-Crypt built into Passlib.

You can see which backend is in use by calling the `get_backend()` method.

## Format & Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#format-algorithm "Permalink to this headline")

An example sha256-crypt hash (of the string `password`) is:

> `$5$rounds=80000$wnsT7Yr92oJoP28r$cKhJImk5mfuSKV9b3mumNzlbstFUplKtQXXMo4G6Ep5`

An sha256-crypt hash string has the format `$5$rounds=rounds$salt$checksum`, where:

- `$5$` is the prefix used to identify sha256-crypt hashes,
following the [Modular Crypt Format](https://passlib.readthedocs.io/en/stable/modular_crypt_format.html#modular-crypt-format)
- `rounds` is the decimal number of rounds to use (80000 in the example).
- `salt` is 0-16 characters drawn from `[./0-9A-Za-z]`, providing a
96-bit salt ( `wnsT7Yr92oJoP28r` in the example).
- `checksum` is 43 characters drawn from the same set, encoding a 256-bit
checksum ( `cKhJImk5mfuSKV9b3mumNzlbstFUplKtQXXMo4G6Ep5` in the example).

The official implementation allows omitting the `rounds` section when it’s set to 5000,
resulting in an alternate hash format: `$5$salt$checksum`.
(Passlib supports this via the `implicit_rounds` constructor parameter).

The algorithm used by SHA256-Crypt is laid out in detail
in the specification document linked to below [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#f1).

## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#security-issues "Permalink to this headline")

- The algorithm’s initialization stage contains a loop which varies linearly with the
square of the password size; and further loops which vary linearly with the
password size \* rounds.


> - This means an attacker could provide a maliciously large password at the login screen
> to attempt a DOS on a publically visible login. For example, a 32kib password
> would require hashing 1gib of data.
> Passlib mitigates this by limiting the maximum password size to 4k by default.
> - An attacker could also theoretically determine a password’s size by observing
> the time taken on a successful login, and then attempting verification themselves
> to find the size password which has an equivalent delay. This has not been applied
> in practice, probably due to the fact that (for normal passwords < 64 bytes),
> the contribution of the password size to the overall time taken is below
> the observable noise level when evesdropping on the timings of successful logins
> for a single user.


## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html\#deviations "Permalink to this headline")

This implementation of sha256-crypt differs from the specification,
and other implementations, in a few ways:

- Zero-Padded Rounds:

The specification does not specify how to deal with zero-padding
within the rounds portion of the hash. No existing examples
or test vectors have zero padding, and allowing it would
result in multiple encodings for the same configuration / hash.
To prevent this situation, Passlib will throw an error if the rounds
parameter in a hash has leading zeros.

- Restricted salt string character set:

The underlying algorithm can unambiguously handle salt strings
which contain any possible byte value besides `\x00` and `$`.
However, Passlib strictly limits salts to the
[`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.HASH64_CHARS "passlib.utils.binary.HASH64_CHARS") character set,
as nearly all implementations of sha256-crypt generate
and expect salts containing those characters,
but may have unexpected behaviors for other character values.

- Unicode Policy:

The underlying algorithm takes in a password specified
as a series of non-null bytes, and does not specify what encoding
should be used; though a `us-ascii` compatible encoding
is implied by nearly all implementations of sha256-crypt
as well as all known reference hashes.

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through sha256-crypt. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| \[1\] | _( [1](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#id1), [2](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#id2))_ Ulrich Drepper’s SHA-256/512-Crypt specification, reference<br>implementation, and test vectors -<br>[sha-crypt specification](http://www.akkadia.org/drepper/sha-crypt.html) |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
      - [Active Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#active-unix-hashes)
        - [`passlib.hash.bcrypt` \- BCrypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt.html)
        - [`passlib.hash.sha256_crypt` \- SHA-256 Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#interface)
          - [Format & Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#format-algorithm)
          - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#security-issues)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html#deviations)
        - [`passlib.hash.sha512_crypt` \- SHA-512 Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html)
        - [`passlib.hash.unix_disabled` \- Unix Disabled Account Helper](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.unix_disabled.html)
      - [Deprecated Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#deprecated-unix-hashes)
      - [Archaic Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#archaic-unix-hashes)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html "passlib.hash.sha512_crypt - SHA-512 Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt.html "passlib.hash.bcrypt - BCrypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.sha256_crypt.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha256_crypt.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.sha256_crypt.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)