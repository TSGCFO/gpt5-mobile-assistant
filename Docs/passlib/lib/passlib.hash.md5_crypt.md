<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha1_crypt.html "passlib.hash.sha1_crypt - SHA-1 Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.unix_disabled.html "passlib.hash.unix_disabled - Unix Disabled Account Helper")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.md5_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#passlib.hash.md5_crypt "passlib.hash.md5_crypt") \- MD5 Crypt [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#passlib-hash-md5-crypt-md5-crypt "Permalink to this headline")

Danger

**This algorithm is not considered secure by modern standards.**
It should only be used when verifying existing hashes,
or when interacting with applications that require this format.
For new code, see the list of [recommended hashes](https://passlib.readthedocs.io/en/stable/narr/quickstart.html#recommended-hashes).

This algorithm was developed for FreeBSD in 1994 by Poul-Henning Kamp,
to replace the aging [`passlib.hash.des_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#passlib.hash.des_crypt "passlib.hash.des_crypt").
It has since been adopted by a wide variety of other Unix flavors, and is found
in many other contexts as well. Due to its origins, it’s sometimes referred to as “FreeBSD MD5 Crypt”.
Security-wise it should now be considered weak,
and most Unix flavors have since replaced it with stronger schemes
(such as [`sha512_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html#passlib.hash.sha512_crypt "passlib.hash.sha512_crypt") and [`bcrypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt.html#passlib.hash.bcrypt "passlib.hash.bcrypt")).

This is also referred to on Cisco IOS systems as a “type 5” hash.
The format and algorithm are identical, though Cisco seems to require
4 salt characters instead of the full 8 characters
used by most systems [\[3\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#cisco).

The `md5_crypt` class can be can be used directly as follows:

```
>>> from passlib.hash import md5_crypt

>>> # generate new salt, hash password
>>> h = md5_crypt.hash("password")
>>> h
'$1$3azHgidD$SrJPt7B.9rekpmwJwtON31'

>>> # verify the password
>>> md5_crypt.verify("password", h)
True
>>> md5_crypt.verify("secret", h)
False

>>> # hash password using cisco-compatible 4-char salt
>>> md5_crypt.using(salt_size=4).hash("password")
'$1$wu98$9UuD3hvrwehnqyF1D548N0'

```

See also

- [password hash usage](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples) – for more usage examples
- [apr\_md5\_crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.apr_md5_crypt.html) – Apache’s variant of this algorithm.

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `md5_crypt` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#passlib.hash.md5_crypt "Permalink to this definition")

This class implements the MD5-Crypt password hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a variable-length salt.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 0-8 characters, drawn from the regexp range `[./0-9A-Za-z]`.<br>- **salt\_size** ( [_int_](https://docs.python.org/3/library/functions.html#int "(in Python v3.9)")) – Optional number of characters to use when autogenerating new salts.<br>  Defaults to 8, but can be any value between 0 and 8.<br>  (This is mainly needed when generating Cisco-compatible hashes,<br>  which require `salt_size=4`).<br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include<br>  `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

Note

This class will use the first available of two possible backends:

- stdlib `crypt()`, if the host OS supports MD5-Crypt (most Unix systems).
- a pure python implementation of MD5-Crypt built into Passlib.

You can see which backend is in use by calling the `get_backend()` method.

## Format [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#format "Permalink to this headline")

An example md5-crypt hash (of the string `password`) is `$1$5pZSV9va$azfrPr6af3Fc7dLblQXVa0`.

An md5-crypt hash string has the format `$1$salt$checksum`, where:

- `$1$` is the prefix used to identify md5-crypt hashes,
following the [Modular Crypt Format](https://passlib.readthedocs.io/en/stable/modular_crypt_format.html#modular-crypt-format)
- `salt` is 0-8 characters drawn from the regexp range `[./0-9A-Za-z]`;
providing a 48-bit salt ( `5pZSV9va` in the example).
- `checksum` is 22 characters drawn from the same character set as the salt;
encoding a 128-bit checksum ( `azfrPr6af3Fc7dLblQXVa0` in the example).

## Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#algorithm "Permalink to this headline")

The MD5-Crypt algorithm [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#f1) calculates a checksum as follows:

1. A password string and salt string are provided.

(The salt should not include the magic prefix,
it should match the string referred to as `salt` in the format section, above).

2. If needed, the salt should be truncated to a maximum of 8 characters.


3. Start MD5 digest B.
4. Add the password to digest B.
5. Add the salt to digest B.
6. Add the password to digest B.
7. Finish MD5 digest B.

8. Start MD5 digest A.

9. Add the password to digest A.

10. Add the constant string `$1$` to digest A.
(The Apache variant of MD5-Crypt uses `$apr1$` instead,
this is the only change made by this variant).

11. Add the salt to digest A.

12. For each block of 16 bytes in the password string,
add digest B to digest A.

13. For the remaining N bytes of the password string,
add the first N bytes of digest B to digest A.

14. For each bit in the binary representation of the length
of the password string; starting with the lowest value bit,
up to and including the largest-valued bit that is set to `1`:


1. If the current bit is set 1, add the first character of the password to digest A.
2. Otherwise, add a NULL character to digest A.

(If the password is the empty string, step 14 is omitted entirely).

15. Finish MD5 digest A.


16. For 1000 rounds (round values 0..999 inclusive),
    perform the following steps:
    1. Start MD5 Digest C for the round.
    2. If the round is odd, add the password to digest C.
    3. If the round is even, add the previous round’s result to digest C (for round 0, add digest A instead).
    4. If the round is not a multiple of 3, add the salt to digest C.
    5. If the round is not a multiple of 7, add the password to digest C.
    6. If the round is even, add the password to digest C.
    7. If the round is odd, add the previous round’s result to digest C (for round 0, add digest A instead).
    8. Use the final value of MD5 digest C as the result for this round.
17. Transpose the 16 bytes of the final round’s result in the
    following order: `12,6,0,13,7,1,14,8,2,15,9,3,5,10,4,11`.
18. Encode the resulting 16 byte string into a 22 character
    [`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64 "passlib.utils.binary.h64")-encoded string
    (the 2 msb bits encoded by the last hash64 character are used as 0 padding).
    This results in the portion of the md5 crypt hash string referred to as `checksum` in the format section.

## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#security-issues "Permalink to this headline")

MD5-Crypt has a couple of issues which have weakened severely:

- It relies on the MD5 message digest, for which theoretical pre-image attacks exist [\[2\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#f2).
- More seriously, its fixed number of rounds (combined with the availability
of high-throughput MD5 implementations) means this algorithm
is increasingly vulnerable to brute force attacks.
It is this issue which has motivated its replacement
by new algorithms such as [`bcrypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt.html#passlib.hash.bcrypt "passlib.hash.bcrypt")
and [`sha512_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha512_crypt.html#passlib.hash.sha512_crypt "passlib.hash.sha512_crypt").

## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html\#deviations "Permalink to this headline")

Passlib’s implementation of md5-crypt differs from the reference implementation (and others) in two ways:

- Restricted salt string character set:

The underlying algorithm can unambiguously handle salt strings
which contain any possible byte value besides `\x00` and `$`.
However, Passlib strictly limits salts to the
[`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.HASH64_CHARS "passlib.utils.binary.HASH64_CHARS") character set,
as nearly all implementations of md5-crypt generate
and expect salts containing those characters,
but may have unexpected behaviors for other character values.

- Unicode Policy:

The underlying algorithm takes in a password specified
as a series of non-null bytes, and does not specify what encoding
should be used; though a `us-ascii` compatible encoding
is implied by nearly all implementations of md5-crypt
as well as all known reference hashes.

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through md5-crypt. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#id2) | The authoritative reference for MD5-Crypt is Poul-Henning Kamp’s original<br>FreeBSD implementation -<br>[http://www.freebsd.org/cgi/cvsweb.cgi/~checkout~/src/lib/libcrypt/crypt.c?rev=1.2](http://www.freebsd.org/cgi/cvsweb.cgi/~checkout~/src/lib/libcrypt/crypt.c?rev=1.2) |

|     |     |
| --- | --- |
| [\[2\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#id3) | Security issues with MD5 -<br>[http://en.wikipedia.org/wiki/MD5#Security](http://en.wikipedia.org/wiki/MD5#Security). |

|     |     |
| --- | --- |
| [\[3\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#id1) | Note about Cisco Type 5 salt size -<br>[http://serverfault.com/a/46399](http://serverfault.com/a/46399). |

|     |     |
| --- | --- |
| \[4\] | Deprecation Announcement from Poul-Henning Kamp - [http://phk.freebsd.dk/sagas/md5crypt\_eol.html](http://phk.freebsd.dk/sagas/md5crypt_eol.html). |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
      - [Active Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#active-unix-hashes)
      - [Deprecated Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#deprecated-unix-hashes)
        - [`passlib.hash.md5_crypt` \- MD5 Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#interface)
          - [Format](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#format)
          - [Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#algorithm)
          - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#security-issues)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html#deviations)
        - [`passlib.hash.sha1_crypt` \- SHA-1 Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha1_crypt.html)
        - [`passlib.hash.sun_md5_crypt` \- Sun MD5 Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sun_md5_crypt.html)
      - [Archaic Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#archaic-unix-hashes)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sha1_crypt.html "passlib.hash.sha1_crypt - SHA-1 Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.unix_disabled.html "passlib.hash.unix_disabled - Unix Disabled Account Helper")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.md5_crypt.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.md5_crypt.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)