<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bsdi_crypt.html "passlib.hash.bsdi_crypt - BSDi Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sun_md5_crypt.html "passlib.hash.sun_md5_crypt - Sun MD5 Crypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.des_crypt`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#passlib.hash.des_crypt "passlib.hash.des_crypt") \- DES Crypt [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#passlib-hash-des-crypt-des-crypt "Permalink to this headline")

Danger

**This algorithm is dangerously insecure by modern standards.**
It is trivially broken, and should not be used if at all possible.
For new code, see the list of [recommended hashes](https://passlib.readthedocs.io/en/stable/narr/quickstart.html#recommended-hashes).

This class implements the original DES-based Unix Crypt algorithm.
While no longer in active use in most places,
it is supported for legacy purposes by many Unix flavors.
It can used directly as follows:

```
>>> from passlib.hash import des_crypt

>>> # generate new salt, hash password
>>> hash = des_crypt.hash("password")
'JQMuyS6H.AGMo'

>>> # verify the password
>>> des_crypt.verify("password", hash)
True
>>> des_crypt.verify("letmein", hash)
False

```

See also

the generic [PasswordHash usage examples](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples)

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `des_crypt` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#passlib.hash.des_crypt "Permalink to this definition")

This class implements the des-crypt password hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a fixed-length salt.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 2 characters, drawn from the regexp range `[./0-9A-Za-z]`.<br>- **truncate\_error** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, des\_crypt will silently truncate passwords larger than 8 bytes.<br>  Setting `truncate_error=True` will cause [`hash()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.hash "passlib.ifc.PasswordHash.hash")<br>  to raise a [`PasswordTruncateError`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasswordTruncateError "passlib.exc.PasswordTruncateError") instead.<br>  <br>  <br>  <br>  New in version 1.7.<br>  <br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include<br>  `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

Note

This class will use the first available of two possible backends:

- stdlib `crypt()`, if the host OS supports DES-Crypt (most Unix systems).
- a pure Python implementation of DES-Crypt built into Passlib.

You can see which backend is in use by calling the `get_backend()` method.

## Format [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#format "Permalink to this headline")

A des-crypt hash string consists of 13 characters, drawn from `[./0-9A-Za-z]`.
The first 2 characters form a [`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64 "passlib.utils.binary.h64")-encoded
12 bit integer used as the salt, with the remaining characters
forming a hash64-encoded 64-bit integer checksum.

A des-crypt configuration string is also accepted by this module,
consists of only the first 2 characters, corresponding to the salt only.

An example hash (of the string `password`) is `JQMuyS6H.AGMo`, where the salt is `JQ`, and the checksum `MuyS6H.AGMo`.

## Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#algorithm "Permalink to this headline")

The checksum is formed by a modified version of the DES cipher in encrypt mode:

1. Given a password string and a salt string.

2. The 2 character salt string is decoded to a 12-bit integer salt value;
The salt string uses little-endian [`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64 "passlib.utils.binary.h64")
encoding.

3. If the password is less than 8 bytes, it’s NULL padded at the end to 8 bytes.

4. The lower 7 bits of the first 8 bytes of the password are used
to form a 56-bit integer; with the first byte providing
the most significant 7 bits, and the 8th byte providing
the least significant 7 bits.

The remainder of the password (if any) is ignored.

5. 25 repeated rounds of modified DES encryption are performed;
starting with a null input block,
and using the 56-bit integer from step 4 as the DES key.

The salt is used to to mutate the normal DES encrypt operation
by swapping bits `i` and `i+24` in the DES E-Box output
if and only if bit `i` is set in the salt value.
Thus, if the salt is set to `0`, normal DES encryption is performed.
(This was intended to prevent optimized implementations
of regular DES encryption to be useful in attacking this algorithm).

6. The 64-bit result of the last round of step 5 is then
lsb-padded with 2 zero bits.

7. The resulting 66-bit integer is encoded in big-endian order using the
[`hash64-big`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.h64big "passlib.utils.binary.h64big") format.


## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#security-issues "Permalink to this headline")

DES-Crypt is no longer considered secure, for a variety of reasons:

- Its use of the DES stream cipher, which is vulnerable to practical pre-image attacks,
and considered broken, as well as having too-small key and block sizes.
- The 12-bit salt is considered to small to defeat rainbow-table attacks
(most modern algorithms provide at least a 48-bit salt).
- The fact that it only uses the lower 7 bits of the first 8 bytes of the password
results in a dangerously small keyspace which needs to be searched.

## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html\#deviations "Permalink to this headline")

This implementation of des-crypt differs from others in a few ways:

- Minimum salt string:

Some implementations of des-crypt permit empty and single-character salt strings.
However, behavior in these cases varies wildly;
with implementations returning everything from errors
to incorrect hashes that never validate.
To avoid all this, Passlib will throw an “invalid salt” if the provided
salt string is not at least 2 characters.

- Restricted salt string character set:

The underlying algorithm expects salt strings to use the
[`hash64`](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.binary.html#passlib.utils.binary.HASH64_CHARS "passlib.utils.binary.HASH64_CHARS") character set to encode
a 12-bit integer. Many implementations of des-crypt will
accept a salt containing other characters, but
vary wildly in how they are handled, including errors and implementation-specific value mappings.
To avoid all this, Passlib will throw an “invalid salt” if the salt
string contains any non-standard characters.

- Unicode Policy:

The original des-crypt algorithm was designed for 7-bit `us-ascii` encoding only
(as evidenced by the fact that it discards the 8th bit of all password bytes).

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through des-crypt. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| \[1\] | A java implementation of des-crypt, used as base for Passlib’s pure-python implementation,<br>can be found at [http://www.dynamic.net.au/christos/crypt/UnixCrypt2.txt](http://www.dynamic.net.au/christos/crypt/UnixCrypt2.txt) |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
      - [Active Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#active-unix-hashes)
      - [Deprecated Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#deprecated-unix-hashes)
      - [Archaic Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#archaic-unix-hashes)
        - [`passlib.hash.des_crypt` \- DES Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#interface)
          - [Format](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#format)
          - [Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#algorithm)
          - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#security-issues)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html#deviations)
        - [`passlib.hash.bsdi_crypt` \- BSDi Crypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bsdi_crypt.html)
        - [`passlib.hash.bigcrypt` \- BigCrypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bigcrypt.html)
        - [`passlib.hash.crypt16` \- Crypt16](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.crypt16.html)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bsdi_crypt.html "passlib.hash.bsdi_crypt - BSDi Crypt")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.sun_md5_crypt.html "passlib.hash.sun_md5_crypt - Sun MD5 Crypt")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.des_crypt.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.des_crypt.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.des_crypt.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)