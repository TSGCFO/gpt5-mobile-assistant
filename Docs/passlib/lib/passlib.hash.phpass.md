<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.pbkdf2_digest.html "passlib.hash.pbkdf2_digest - Generic PBKDF2 Hashes")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt_sha256.html "passlib.hash.bcrypt_sha256 - BCrypt+SHA256")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.phpass`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#passlib.hash.phpass "passlib.hash.phpass") \- PHPass’ Portable Hash [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#passlib-hash-phpass-phpass-portable-hash "Permalink to this headline")

This algorithm is used primarily by PHP software
which uses PHPass [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#pp),
a PHP library similar to Passlib. The PHPass Portable Hash
is a custom password hash used by PHPass as a fallback
when none of its other hashes are available.
Due to its reliance on MD5, and the simplistic implementation,
other hash algorithms should be used if possible.

See also

[password hash usage](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples) –
for examples of how to use this class via the common hash interface.

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `phpass` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#passlib.hash.phpass "Permalink to this definition")

This class implements the PHPass Portable Hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a fixed-length salt, and a variable number of rounds.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – Optional salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>  If specified, it must be 8 characters, drawn from the regexp range `[./0-9A-Za-z]`.<br>- **rounds** ( [_int_](https://docs.python.org/3/library/functions.html#int "(in Python v3.9)")) – Optional number of rounds to use.<br>  Defaults to 19, must be between 7 and 30, inclusive.<br>  This value is logarithmic, the actual number of iterations used will be `2**rounds`.<br>- **ident** ( [_str_](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.9)")) – phpBB3 uses `H` instead of `P` for its identifier,<br>  this may be set to `H` in order to generate phpBB3 compatible hashes.<br>  it defaults to `P`.<br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include `rounds`<br>  that are too small or too large, and `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

## Format [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#format "Permalink to this headline")

An example hash (of `password`) is `$P$8ohUJ.1sdFw09/bMaAQPTGDNi2BIUt1`.
A phpass portable hash string has the format `$P$roundssaltchecksum`, where:

- `$P$` is the prefix used to identify phpass hashes,
following the [Modular Crypt Format](https://passlib.readthedocs.io/en/stable/modular_crypt_format.html#modular-crypt-format).
- `rounds` is a single character encoding a 6-bit integer
representing the number of rounds used. This is logarithmic,
the real number of rounds is `2**rounds`. (in the example, rounds is encoded as `8`, or 2\*\*13 iterations).
- `salt` is eight characters drawn from `[./0-9A-Za-z]`,
providing a 48-bit salt ( `ohUJ.1sd` in the example).
- `checksum` is 22 characters drawn from the same set,
encoding the 128-bit checksum ( `Fw09/bMaAQPTGDNi2BIUt1` in the example).

Note

Note that phpBB3 databases uses the alternate prefix `$H$`, both prefixes
are recognized by this implementation, and the checksums are the same.

## Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#algorithm "Permalink to this headline")

PHPass uses a straightforward algorithm to calculate the checksum:

1. an initial result is generated from the MD5 digest of the salt string + the secret.
2. for `2**rounds` iterations, a new result is created from the MD5 digest of the last result + the password.
3. the last result is then encoded according to the format described above.

## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html\#deviations "Permalink to this headline")

This implementation of phpass differs from the specification in one way:

- Unicode Policy:

The underlying algorithm takes in a password specified
as a series of non-null bytes, and does not specify what encoding
should be used; though a `us-ascii` compatible encoding
is implied by nearly all known reference hashes.

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through phpass. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#id1) | PHPass homepage, which describes the Portable Hash algorithm -<br>[http://www.openwall.com/phpass/](http://www.openwall.com/phpass/) |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
      - [Active Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#active-hashes)
        - [`passlib.hash.argon2` \- Argon2](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.argon2.html)
        - [`passlib.hash.bcrypt_sha256` \- BCrypt+SHA256](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt_sha256.html)
        - [`passlib.hash.phpass` \- PHPass’ Portable Hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#interface)
          - [Format](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#format)
          - [Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#algorithm)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html#deviations)
        - [`passlib.hash.pbkdf2_digest` \- Generic PBKDF2 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.pbkdf2_digest.html)
        - [`passlib.hash.scram` \- SCRAM Hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.scram.html)
        - [`passlib.hash.scrypt` \- SCrypt](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.scrypt.html)
      - [Deprecated Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#deprecated-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.pbkdf2_digest.html "passlib.hash.pbkdf2_digest - Generic PBKDF2 Hashes")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.bcrypt_sha256.html "passlib.hash.bcrypt_sha256 - BCrypt+SHA256")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.phpass.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.phpass.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.phpass.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)