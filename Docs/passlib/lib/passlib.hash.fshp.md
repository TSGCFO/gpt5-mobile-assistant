<!-- Source: https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html -->

### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html "passlib.hash.mssql2000 - MS SQL 2000 password hash")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.atlassian_pbkdf2_sha1.html "passlib.hash.atlassian_pbkdf2_sha1 - Atlassian’s PBKDF2-based Hash")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

# [`passlib.hash.fshp`](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#passlib.hash.fshp "passlib.hash.fshp") \- Fairly Secure Hashed Password [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#passlib-hash-fshp-fairly-secure-hashed-password "Permalink to this headline")

Note

While the SHA-2 variants of PBKDF1 have no critical security vulnerabilities,
PBKDF1 itself has been deprecated in favor of its successor, PBKDF2.
Furthermore, FSHP has been listed as insecure by its author (for unspecified reasons);
so this scheme should probably only be used to support existing hashes.

The Fairly Secure Hashed Password (FSHP) scheme [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#home)
is a cross-platform hash based on PBKDF1 [\[2\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#pbk), and uses an LDAP-style hash format.
It features a variable length salt, variable rounds, and support for cryptographic
hashes from SHA-1 up to SHA-512.
This class supports the standard Passlib options for rounds and salt,
as well as a special digest keyword for selecting the variant of FSHP to use.
It can be used directly as follows:

```
>>> from passlib.hash import fshp

>>> # generate new salt, hash password
>>> hash = fshp.hash("password")
>>> hash
'{FSHP1|16|16384}PtoqcGUetmVEy/uR8715TNqKa8+teMF9qZO1lA9lJNUm1EQBLPZ+qPRLeEPHqy6C'

>>> # the same, but with an explicit number of rounds, larger salt, and specific variant
>>> fshp.using(rounds=40000, salt_size=32, variant="sha512").hash("password")
'{FSHP3|32|40000}cB8yE/CuADSgUTQZjWy+YTf/cvbU11D/rHNKiUiB6z4dIaO77U/rmNW
pgZcZllZbCra5GJ8ZfFRNwCHirPqvYTAnbaQQeFQbWym/frRrRev3buoygFQRYexl4091Pc5m'

>>> # verify password
>>> fshp.verify("password", hash)
True
>>> fshp.verify("secret", hash)
False

```

See also

the generic [PasswordHash usage examples](https://passlib.readthedocs.io/en/stable/narr/hash-tutorial.html#password-hash-examples)

## Interface [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#interface "Permalink to this headline")

_class_ `passlib.hash.` `fshp` [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#passlib.hash.fshp "Permalink to this definition")

This class implements the FSHP password hash, and follows the [PasswordHash API](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#password-hash-api).

It supports a variable-length salt, and a variable number of rounds.

The [`using()`](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html#passlib.ifc.PasswordHash.using "passlib.ifc.PasswordHash.using") method accepts the following optional keywords:

| Parameters: | - **salt** – Optional raw salt string.<br>  If not specified, one will be autogenerated (this is recommended).<br>- **salt\_size** – Optional number of bytes to use when autogenerating new salts.<br>  Defaults to 16 bytes, but can be any non-negative value.<br>- **rounds** – Optional number of rounds to use.<br>  Defaults to 480000, must be between 1 and 4294967295, inclusive.<br>- **variant** – <br>  Optionally specifies variant of FSHP to use.<br>  <br>  - `0` \- uses SHA-1 digest (deprecated).<br>  - `1` \- uses SHA-2/256 digest (default).<br>  - `2` \- uses SHA-2/384 digest.<br>  - `3` \- uses SHA-2/512 digest.<br>- **relaxed** ( [_bool_](https://docs.python.org/3/library/functions.html#bool "(in Python v3.9)")) – <br>  By default, providing an invalid value for one of the other<br>  keywords will result in a [`ValueError`](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.9)"). If `relaxed=True`,<br>  and the error can be corrected, a [`PasslibHashWarning`](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html#passlib.exc.PasslibHashWarning "passlib.exc.PasslibHashWarning")<br>  will be issued instead. Correctable errors include `rounds`<br>  that are too small or too large, and `salt` strings that are too long.<br>  <br>  <br>  <br>  New in version 1.6. |

## Format & Algorithm [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#format-algorithm "Permalink to this headline")

All of this scheme’s hashes have the format: `{FSHPvariant|saltsize|rounds}data`.
A example hash (of `password`) is:

> `{FSHP1|16|16384}PtoqcGUetmVEy/uR8715TNqKa8+teMF9qZO1lA9lJNUm1EQBLPZ+qPRLeEPHqy6C`

- `variant` is a decimal integer identifying the version of FSHP;
in particular, which cryptographic hash function should be used
to calculate the checksum. `1` in the example.
(see the class description above for a list of possible values).

- `saltsize` is a decimal integer identifying the number of bytes
in the salt. `16` in the example.

- `rounds` is a decimal integer identifying the number
of rounds to apply when calculating the checksum (see below).
`16384` in the example.

- `data` is a base64-encoded string which, when decoded,
contains a salt string of the specified size, followed
by the checksum. In the example, the data portion decodes to
a salt value (in hexadecimal octets) of:


> `3eda2a70651eb66544cbfb91f3bd794c`


and a checksum value (in hexadecimal octets) of:


> `da8a6bcfad78c17da993b5940f6524d526d444012cf67ea8f44b7843c7ab2e82`


FSHP is basically just a wrapper around PBKDF1:
The checksum is calculated using [`pbkdf1()`](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.digest.html#passlib.crypto.digest.pbkdf1 "passlib.crypto.digest.pbkdf1"),
passing in the password, the decoded salt string, the number of
rounds, and hash function specified by the variant identifier.
FSHP has one quirk in that the password is passed in as the pbkdf1 salt,
and the salt is passed in as the pbkdf1 password.

## Security Issues [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#security-issues "Permalink to this headline")

- A minor issue is that FSHP swaps the location the password and salt
from what is described in the PBKDF1 standard.
This issue is mainly noted in order to dismiss it:
while the swap permits an attacker to pre-calculate part of the initial digest,
the impact of this is negligible when a large number of rounds is used.
- Since PBKDF1 is based on repeated composition of a hash,
it is vulnerable to any first-preimage attacks on the underlying hash.
This has led to the deprecation of using SHA-1 or earlier hashes with PBKDF1.
In contrast, its successor PBKDF2 was designed to mitigate
this weakness (among other things), and enjoys much stronger preimage resistance
when used with the same cryptographic hashes.

## Deviations [¶](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html\#deviations "Permalink to this headline")

- Unicode Policy:

The official FSHP python implementation takes in a password specified
as a series of bytes, and does not specify what encoding
should be used; though a `us-ascii` compatible encoding
is implied by the implementation,
as well as all known reference hashes.

In order to provide support for unicode strings,
Passlib will encode unicode passwords using `utf-8`
before running them through FSHP. If a different
encoding is desired by an application, the password should be encoded
before handing it to Passlib.


Footnotes

|     |     |
| --- | --- |
| [\[1\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#id1) | The FSHP homepage contains implementations in a wide variety of<br>programming languages – [https://github.com/bdd/fshp-is-not-secure-anymore](https://github.com/bdd/fshp-is-not-secure-anymore). |

|     |     |
| --- | --- |
| [\[2\]](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#id2) | rfc defining PBKDF1 & PBKDF2 -<br>[http://tools.ietf.org/html/rfc2898](http://tools.ietf.org/html/rfc2898) - |

[![Logo](https://passlib.readthedocs.io/en/stable/_static/masthead.png)](https://passlib.readthedocs.io/en/stable/index.html "index")

### Quick search

### [Table of Contents](https://passlib.readthedocs.io/en/stable/contents.html)

- [Introduction](https://passlib.readthedocs.io/en/stable/index.html)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html)
  - [`passlib.apache` \- Apache Password Files](https://passlib.readthedocs.io/en/stable/lib/passlib.apache.html)
  - [`passlib.apps` \- Helpers for various applications](https://passlib.readthedocs.io/en/stable/lib/passlib.apps.html)
  - [`passlib.context` \- CryptContext Hash Manager](https://passlib.readthedocs.io/en/stable/lib/passlib.context.html)
  - [`passlib.crypto` \- Cryptographic Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.crypto.html)
  - [`passlib.exc` \- Exceptions and warnings](https://passlib.readthedocs.io/en/stable/lib/passlib.exc.html)
  - [`passlib.ext.django` \- Django Password Hashing Plugin](https://passlib.readthedocs.io/en/stable/lib/passlib.ext.django.html)
  - [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html)
    - [Overview](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#overview)
    - [Unix Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#unix-hashes)
    - [Other “Modular Crypt” Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-modular-crypt-hashes)
    - [LDAP / RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ldap-rfc2307-hashes)
      - [Standard LDAP Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#standard-ldap-schemes)
      - [Non-Standard LDAP Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#non-standard-ldap-schemes)
        - [`passlib.hash.ldap_other` \- Non-Standard RFC2307 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.ldap_other.html)
        - [`passlib.hash.ldap_pbkdf2_digest` \- Generic PBKDF2 Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.ldap_pbkdf2_digest.html)
        - [`passlib.hash.atlassian_pbkdf2_sha1` \- Atlassian’s PBKDF2-based Hash](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.atlassian_pbkdf2_sha1.html)
        - [`passlib.hash.fshp` \- Fairly Secure Hashed Password](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#)
          - [Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#interface)
          - [Format & Algorithm](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#format-algorithm)
          - [Security Issues](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#security-issues)
          - [Deviations](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html#deviations)
    - [SQL Database Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#sql-database-hashes)
    - [MS Windows Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#ms-windows-hashes)
    - [Cisco Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#cisco-hashes)
    - [Other Hashes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html#other-hashes)
  - [`passlib.hosts` \- OS Password Handling](https://passlib.readthedocs.io/en/stable/lib/passlib.hosts.html)
  - [`passlib.ifc` – Password Hash Interface](https://passlib.readthedocs.io/en/stable/lib/passlib.ifc.html)
  - [`passlib.pwd` – Password generation helpers](https://passlib.readthedocs.io/en/stable/lib/passlib.pwd.html)
  - [`passlib.registry` \- Password Handler Registry](https://passlib.readthedocs.io/en/stable/lib/passlib.registry.html)
  - [`passlib.totp` – TOTP / Two Factor Authentication](https://passlib.readthedocs.io/en/stable/lib/passlib.totp.html)
  - [`passlib.utils` \- Helper Functions](https://passlib.readthedocs.io/en/stable/lib/passlib.utils.html)
- [Other Documentation](https://passlib.readthedocs.io/en/stable/other.html)

«
hide menumenusidebar
»


### Navigation

- [index](https://passlib.readthedocs.io/en/stable/genindex.html "General Index")
- [modules](https://passlib.readthedocs.io/en/stable/py-modindex.html "Python Module Index")
- [toc](https://passlib.readthedocs.io/en/stable/contents.html "Table Of Contents")
- [next](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.mssql2000.html "passlib.hash.mssql2000 - MS SQL 2000 password hash")
- [previous](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.atlassian_pbkdf2_sha1.html "passlib.hash.atlassian_pbkdf2_sha1 - Atlassian’s PBKDF2-based Hash")
- [Passlib 1.7 Documentation](https://passlib.readthedocs.io/en/stable/index.html) »
- [API Reference](https://passlib.readthedocs.io/en/stable/lib/index.html) »
- [`passlib.hash` \- Password Hashing Schemes](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.html) »

Versions[latest](https://passlib.readthedocs.io/en/latest/lib/passlib.hash.fshp.html)**[stable](https://passlib.readthedocs.io/en/stable/lib/passlib.hash.fshp.html)**[1.7.3](https://passlib.readthedocs.io/en/1.7.3/lib/passlib.hash.fshp.html)Downloads[PDF](https://passlib.readthedocs.io/_/downloads/en/stable/pdf/)[HTML](https://passlib.readthedocs.io/_/downloads/en/stable/htmlzip/)On Read the Docs[Project Home](https://app.readthedocs.org/projects/passlib/?utm_source=passlib&utm_content=flyout)[Builds](https://app.readthedocs.org/projects/passlib/builds/?utm_source=passlib&utm_content=flyout)Search

* * *

[Addons documentation](https://docs.readthedocs.io/page/addons.html?utm_source=passlib&utm_content=flyout) ― Hosted by
[Read the Docs](https://about.readthedocs.com/?utm_source=passlib&utm_content=flyout)